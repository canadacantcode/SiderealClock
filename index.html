<!DOCTYPE html>
<!--
  Layout, styling, and JavaScript structure were assisted by AI,
  but the underlying research, equations, and time relationships
  were researched and selected by Cole and Tushaar.

  We are currently working on:
  - Adding 2D visual models for Mars/Earth to show a larger
    difference in the Mars times
  - Updating the time calculations to make them more accurate
    (including Mars’s orbit and timing data)
-->
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sidereal / Solar Clocks</title>

  <!-- Digital clock-style font for the large time readouts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">

  <!-- Extra fonts (not heavily used right now, but kept for flexibility) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=JetBrains+Mono:wght@500;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #0d1117;
      --card: #0f172a;
      --text: #e6edf3;
      --muted: #94a3b8;
      --accent: #ff4d4d;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: Arial, Helvetica, sans-serif;
      background: linear-gradient(180deg,#0d1117 0%, #0b1220 100%);
      color: var(--text);
      min-height: 100vh;
      display: grid;
      place-items: start center;
      padding: 32px 16px;
    }

    .wrap { width: 100%; max-width: 1100px; }

    h1 { font-weight: 800; letter-spacing: 0.5px; margin: 0 0 4px; }
    p.lede { margin: 0 0 24px; color: var(--muted); }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 16px;
    }

    .card {
      background: var(--card);
      border: 1px solid rgba(148,163,184,0.15);
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 12px 30px rgba(0,0,0,0.35);
    }

    .label {
      font-size: 16px;
      font-weight: 700;
      letter-spacing: 0.2px;
      color: var(--text);
      text-transform: none;
    }

    .big {
      font-size: 56px;
      font-family: 'Orbitron', Arial, Helvetica, sans-serif;
      font-weight: 700;
      font-variant-numeric: tabular-nums;
      letter-spacing: 2px;
      margin-top: 6px;
    }

    .sub { font-size: 13px; color: var(--muted); margin-top: 6px; }

    .row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }

    .controls {
      margin: 18px 0 26px;
      padding: 16px;
      border: 1px dashed rgba(122,162,255,0.35);
      border-radius: 14px;
    }

    input[type=range]{
      width:100%;
      -webkit-appearance:none;
      height:4px;
      background:rgba(255,255,255,0.12);
      border-radius:999px;
      outline:none;
    }
    input[type=range]::-webkit-slider-thumb{
      -webkit-appearance:none;
      width:16px; height:16px;
      border-radius:50%;
      background:var(--accent);
      box-shadow:0 0 0 3px rgba(255,77,77,0.25);
      border:none;
    }
    input[type=range]::-moz-range-thumb{
      width:16px; height:16px;
      border-radius:50%;
      background:var(--accent);
      border:none;
    }

    .mono { font-family: Arial, Helvetica, sans-serif; font-variant-numeric: tabular-nums; }
    .muted { color: var(--muted); }

    .foot {
      margin-top: 24px;
      font-size: 12px;
      color: var(--muted);
      line-height: 1.5;
    }

    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }

    #bg{
      position:fixed;
      inset:0;
      z-index:-1;
      display:block;
    }

    .marsCard{
      border:1px solid rgba(255,77,77,0.55)!important;
      box-shadow:0 0 10px rgba(255,77,77,0.35);
    }
    .redBorder{
      border:1px solid rgba(255,77,77,0.55)!important;
      box-shadow:0 0 10px rgba(255,77,77,0.35);
    }
    .earthCard{
      border:1px solid rgba(255,255,255,0.45)!important;
      box-shadow:0 0 10px rgba(255,255,255,0.25);
    }

    /* Dropdowns */
    .detailsBox {
      margin-top: 14px;
      border: 1px solid rgba(255,77,77,0.35);
      border-radius: 12px;
      background: rgba(255,77,77,0.06);
      overflow: hidden;
    }

    .detailsBox summary {
      cursor: pointer;
      list-style: none;
      padding: 12px;
      font-weight: 700;
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .detailsBox summary::-webkit-details-marker { display: none; }

    .detailsBox .content {
      padding: 12px 12px 14px;
      border-top: 1px solid rgba(255,77,77,0.25);
      color: var(--muted);
      font-size: 13px;
      line-height: 1.45;
    }

    .animPlaceholder {
      margin-top: 10px;
      width: 100%;
      height: 220px;
      border-radius: 10px;
      border: 1px dashed rgba(255,77,77,0.45);
      background: rgba(0,0,0,0.18);
      display: grid;
      place-items: center;
      color: rgba(255,255,255,0.65);
      font-size: 12px;
      overflow: hidden;
      position: relative;
    }

    .detailsBox .arrow {
      font-size: 14px;
      color: rgba(255,255,255,0.8);
      transition: transform 0.25s ease;
    }
    .detailsBox[open] .arrow {
      transform: rotate(180deg);
    }
  </style>
</head>

<body>
  <canvas id="bg"></canvas>

  <header style="width:100%; max-width:1100px; margin:0 auto 16px auto; display:flex; justify-content:space-between; align-items:center; color:#e6edf3; font-family: Arial, Helvetica, sans-serif; font-size:14px;">
    <div style="font-weight:700; font-size:20px;">Mars & Earth Time</div>
    <nav style="display:flex; gap:16px; font-size:14px;">
      <a href="index.html" style="color:inherit; text-decoration:none; border-bottom:2px solid #ff4d4d;">Clocks</a>
      <a href="purpose.html" style="color:inherit; text-decoration:none; opacity:0.8;">Our Purpose</a>
      <a href="reference.html" style="color:inherit; text-decoration:none; opacity:0.8;">References</a>
    </nav>
  </header>

  <div class="wrap">
    <h1>Sidereal / Solar Clocks</h1>
    <p class="lede">
      All times referenced to prime meridians (Earth: Greenwich, Mars: Airy-0 at
      <span class="mono">0°</span> longitude). Mars clocks can run faster so a sol advances quicker on screen.
    </p>

    <div class="controls redBorder">
      <div class="row">
        <div>
          <div class="label">Mars Clock Speed</div>
          <div class="sub">Multiplies the passage of time for Mars clocks only (visualization aid).</div>
        </div>
        <div class="mono" id="speedLabel">1.00×</div>
      </div>
      <input id="speed" type="range" min="0.1" max="30" step="0.1" value="1" />
    </div>

    <div class="grid">

      <div class="card earthCard">
        <div class="label">Earth — Solar Time</div>
        <div class="big" id="earthSolar">--:--:--</div>
        <div class="sub">Civil (sun-based) time using Coordinated Universal Time.</div>
      </div>

      <div class="card earthCard">
        <div class="label">Earth — Sidereal Time</div>
        <div class="big" id="earthSidereal">--:--:--</div>
        <div class="sub">Greenwich Mean Sidereal Time, Earth’s rotation relative to the stars.</div>
      </div>

      <div class="card marsCard">
        <div class="label">Mars — Solar Time</div>
        <div class="big" id="marsSolar">--:--:--</div>
        <div class="sub">Mars Coordinated Time, the sun-based time at 0° longitude (Airy-0).</div>

        <details class="detailsBox">
          <summary>
            <span>Solar Time Visual</span>
            <span class="arrow">▼</span>
          </summary>
          <div class="content">
           <iframe
  src="mars-solar/index.html"
  style="
    width: 100%;
    height: 420px;
    border: none;
    border-radius: 10px;
    background: rgba(0,0,0,0.25);
  "
  loading="lazy"
></iframe>

          </div>
        </details>
      </div>

      <div class="card marsCard">
        <div class="label">Mars — Sidereal Time</div>
        <div class="big" id="marsSidereal">--:--:--</div>
        <div class="sub">Mars’s rotation relative to the stars, shown as a time value.</div>

        <details class="detailsBox">
          <summary>
            <span>Sidereal Time Visual</span>
            <span class="arrow">▼</span>
          </summary>

          <div class="content">
<iframe
  src="mars-sidereal/index.html"
  style="
    width: 100%;
    height: 420px;
    border: none;
    border-radius: 10px;
    background: rgba(0,0,0,0.25);
  "
  loading="lazy"
></iframe>
          </div>
        </details>
      </div>

    </div>
  </div>

  <!-- Star background script -->
  <script>
    (function(){
      const c = document.getElementById('bg');
      if (!c) return;
      const ctx = c.getContext('2d');
      let w, h, stars = [];

      function resize() {
        w = window.innerWidth;
        h = window.innerHeight;
        c.width = w;
        c.height = h;
      }

      function rnd(n){ return Math.random() * n; }

      function init(){
        stars = Array.from({length: 140}, () => ({
          x: rnd(w),
          y: rnd(h),
          r: Math.random() * 1.5 + 0.2,
          s: Math.random() * 0.6 + 0.2
        }));
      }

      function draw(){
        ctx.fillStyle = '#0b1020';
        ctx.fillRect(0, 0, w, h);

        ctx.fillStyle = 'rgba(255,255,255,0.9)';
        for (const p of stars) {
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
          ctx.fill();

          p.y += p.s * 0.25;
          if (p.y > h) {
            p.y = -2;
            p.x = rnd(w);
          }
        }
        requestAnimationFrame(draw);
      }

      window.addEventListener('resize', () => { resize(); init(); });
      resize(); init(); draw();
    })();
  </script>

  <!-- MAIN CLOCK LOGIC -->
  <script>
    const MS_PER_DAY = 86400000;

    const EARTH_SIDEREAL_DAY_S = 86164.0905;
    const EARTH_SOLAR_DAY_S    = 86400.0;

    const MARS_SOLAR_DAY_S     = 88775.244;
    const MARS_SIDEREAL_DAY_S  = 88642.663;

    const JD_J2000 = 2451545.0;
    const APPROX_TT_MINUS_UTC_S = 101.184;

    function toJulianDateUTC(dateUtc) {
      return dateUtc.getTime() / MS_PER_DAY + 2440587.5;
    }
    function frac(x) { return x - Math.floor(x); }

    function hmsFromHours(hours) {
      hours = ((hours % 24) + 24) % 24;
      const h = Math.floor(hours);
      const mFloat = (hours - h) * 60;
      const m = Math.floor(mFloat);
      const s = Math.floor((mFloat - m) * 60);
      return `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
    }

    function gmstHours(dateUtc) {
      const jd = toJulianDateUTC(dateUtc);
      const T = (jd - JD_J2000) / 36525.0;
      const gmstSec =
        67310.54841 +
        (876600 * 3600 + 8640184.812866) * T +
        0.093104 * T*T -
        6.2e-6 * T*T*T;
      return ((gmstSec / 3600) % 24 + 24) % 24;
    }

    function marsMSD(dateUtc, ttMinusUtcSeconds = APPROX_TT_MINUS_UTC_S) {
      const jdUTC = toJulianDateUTC(dateUtc);
      const jdTT  = jdUTC + ttMinusUtcSeconds / 86400.0;
      return (jdTT - 2405522.0028779) / 1.0274912517;
    }

    function marsMTC_Hours(dateUtc) {
      const msd = marsMSD(dateUtc);
      return 24.0 * frac(msd);
    }

    function marsSiderealHours(dateUtc) {
      const jdUTC = toJulianDateUTC(dateUtc);
      const secondsSinceJ2000 = (jdUTC - JD_J2000) * 86400.0;
      const rotations = secondsSinceJ2000 / MARS_SIDEREAL_DAY_S;
      return ((rotations % 1 + 1) % 1) * 24.0;
    }

    const el = {
      earthSolar:   document.getElementById('earthSolar'),
      earthSidereal:document.getElementById('earthSidereal'),
      marsSolar:    document.getElementById('marsSolar'),
      marsSidereal: document.getElementById('marsSidereal'),
      speed:        document.getElementById('speed'),
      speedLabel:   document.getElementById('speedLabel'),
    };

    let marsSpeed = parseFloat(el.speed.value);
    let lastReal = performance.now();
    let marsSimOffsetMs = 0;

    el.speed.addEventListener('input', () => {
      marsSpeed = parseFloat(el.speed.value);
      el.speedLabel.textContent = marsSpeed.toFixed(2) + '×';
    });

    function tick(now) {
      const dt = now - lastReal;
      lastReal = now;

      marsSimOffsetMs += dt * (marsSpeed - 1.0);

      const realUtc = new Date();
      const marsSimUtc = new Date(realUtc.getTime() + marsSimOffsetMs);

      el.earthSolar.textContent = realUtc.toISOString().substring(11, 19);
      el.earthSidereal.textContent = hmsFromHours(gmstHours(realUtc));
      el.marsSolar.textContent = hmsFromHours(marsMTC_Hours(marsSimUtc));
      el.marsSidereal.textContent = hmsFromHours(marsSiderealHours(marsSimUtc));

      requestAnimationFrame(tick);
    }

    el.speedLabel.textContent = marsSpeed.toFixed(2) + '×';
    lastReal = performance.now();
    requestAnimationFrame(tick);
  </script>

  <div class="foot">
    This clock currently uses simplified calculations to estimate Earth and Mars rotation times.
    We plan to update it later with more accurate formulas that account for Mars’s elliptical orbit
    and improved timing data.
  </div>
</body>
</html>
